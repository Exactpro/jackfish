#Id;#TestCase;#Kind;#Depends;#For
INIT;Test case;Never;;
    #Id;#Global;#Let
    getExp;1;def (pl, v1, v2, v3) {if(pl == 'Web') {return v1\u003b}if(pl == 'Swing') {return v2\u003b}if(pl == 'Win') {return v3\u003b}}\u003b

    #Id;#Global;#Let
    getDelay;1;def (pl) {if(pl == 'Web') {return 10\u003b}if(pl == 'Swing') {return 1000\u003b}if(pl == 'Win') {return 10\u003b}}\u003b

    // {web,swing,win} or All
    #Id;#Global;#RawTable
    controls;1;Table
    @;On;Before;getRowPar;getRow;colorPar;Name;toggle;getAttr;getAttrPar;getValue;select;get;setValue;text;getList;check;getListPar;getValuePar
    0;x;'Do.use(\'Label\').move()';'\'tr_3_td_3\'';;'new Color(246,246,246)';Label;;'CentralLabel';'\'CentralLabel\'';'CentralLabel';;'CentralLabel';;;;'CentralLabel';'new ArrayList([\'Green\',\'Yellow\', \'Orange\',\'Blue\']),false';'\'CentralLabel\''
    1;x;;'\'tr_3_td_3\'';;'new Color(246,246,246)';Button;;'Button';'\'Button\'';'Button';;'Button';;;;'Button';'new ArrayList([\'Green\',\'Yellow\', \'Orange\',\'Blue\']),false';'\'Button\''
    2;x;;'\'tr_3_td_3\'';;'new Color(246,246,246)';TextBox;;getExp(plugin,'TextBox','TextBox','Slider_click');'\'TextBox\'';'';;'';;'Green';;'';'new ArrayList([\'Green\',\'Yellow\', \'Orange\',\'Blue\']),false';'\'\''
    3;x;;'\'tr_3_td_3\'';;'new Color(246,246,246)';Any;;'Any';'\'Any\'';;;;;;;true;'new ArrayList([\'Green\',\'Yellow\', \'Orange\',\'Blue\']),false';'\'\''
    4;x;'Do.use(\'CheckBox\').move()';'\'tr_3_td_3\'';;'new Color(246,246,246)';CheckBox;getExp(plugin,'true','true','On');'CheckBox';'\'CheckBox\'';getExp(plugin,true,true,'On');;'CheckBox';;;;true;'new ArrayList([\'Green\',\'Yellow\', \'Orange\',\'Blue\']),false';getExp(plugin,'\'true\'','\'true\'','\'On\'')
    5;x;'Do.use(\'ToggleButton\').move()';'\'tr_3_td_3\'';;'new Color(246,246,246)';ToggleButton;getExp(plugin,'true','true','On');'ToggleButton';'\'ToggleButton\'';getExp(plugin,true,true,'On');;'ToggleButton';;;;true;'new ArrayList([\'Green\',\'Yellow\', \'Orange\',\'Blue\']),false';getExp(plugin,'\'true\'','\'true\'','\'On\'')
    6;x;;'\'tr_3_td_3\'';;'new Color(246,246,246)';ComboBox;;getExp(plugin,'ComboBox','ComboBox','Green');getExp(plugin,'\'ComboBox\'','\'ComboBox\'','\'Green\'');'Green';'Blue';'Green';;'Green';'[Green, Yellow, Orange, Blue]';'Green';'new ArrayList([\'Green\',\'Yellow\', \'Orange\',\'Blue\']),false';'\'Green\''
    7;x;;'\'tr_3_td_3\'';'{Head1=tr_3_td_1, Head2=tr_3_td_2, Head3=tr_3_td_3}';'new Color(246,246,246)';Table;;getExp(plugin,'Table','Table','DataGridView');getExp(plugin,'\'Table\'','\'Table\'','\'DataGridView\'');'tr_2_td_2';;;;getExp(plugin,'tr_2_td_2','Green','Green');;'tr_2_td_2';'new ArrayList([\'Green\',\'Yellow\', \'Orange\',\'Blue\']),false';'\'tr_2_td_2\''
    8;x;'Do.use(\'Slider\').setValue(0)';'\'tr_3_td_3\'';;'new Color(246,246,246)';Slider;;getExp(plugin,'Slider','Slider','');getExp(plugin,'\'Slider\'','\'Slider\'','\'\'');getExp(plugin,'',0,'0');;;'Slider_30';;;getExp(plugin,'',0,'0');'new ArrayList([\'Green\',\'Yellow\', \'Orange\',\'Blue\']),false';getExp(plugin,'\'\'','0','0')
    9;x;;'\'tr_3_td_3\'';;'new Color(246,246,246)';RadioButton;getExp(plugin,'true','true','True');getExp(plugin,'RadioButton','RadioButton','Green');getExp(plugin,'\'RadioButton\'','\'RadioButton\'','\'Green\'');getExp(plugin,'false','false','False');;'Green';;;;false;'new ArrayList([\'Green\',\'Yellow\', \'Orange\',\'Blue\']),false';getExp(plugin,'\'false\'','\'false\'','\'False\'')
    10;x;;'\'tr_3_td_3\'';;'new Color(246,246,246)';ProgressBar;;getExp(plugin,'ProgressBar','ProgressBar','');getExp(plugin,'\'ProgressBar\'','\'ProgressBar\'','\'\'');10;;;;;;true;'new ArrayList([\'Green\',\'Yellow\', \'Orange\',\'Blue\']),false';'\'10\''
    11;x;;'\'tr_3_td_3\'';;'new Color(246,246,246)';Panel;;'Panel';'\'Panel\'';'Panel';;;;'Panel';;true;'new ArrayList([\'Green\',\'Yellow\', \'Orange\',\'Blue\']),false';'\'Panel\''
    12;x;'Do.use(\'List\').select(\'Green\')';'\'tr_3_td_3\'';;'new Color(246,246,246)';List;;getExp(plugin,'List','List','tab2');getExp(plugin,'\'List\'','\'List\'','\'tab2\'');getExp(plugin,'Green\nYellow\nOrange\nBlue','Green','Green');getExp(plugin,'Green\nYellow\nOrange\nBlue','Blue','Blue');;;;'[Green, Yellow, Orange, Blue]';true;'new ArrayList([\'Green\',\'Yellow\', \'Orange\',\'Blue\']),false';getExp(plugin,'\'Green\nYellow\nOrange\nBlue\'','\'Green\'','\'Green\'')
    13;x;'Do.use(\'Dialog\').move()';'\'tr_3_td_3\'';;'new Color(246,246,246)';Dialog;;'Dialog';'\'Dialog\'';;;;;;;true;'new ArrayList([\'Green\',\'Yellow\', \'Orange\',\'Blue\']),false';'\'\''
    14;x;'Do.use(\'Image\').move()';'\'tr_3_td_3\'';;'new Color(246,246,246)';Image;;'Image';'\'Image\'';;;;;;;true;'new ArrayList([\'Green\',\'Yellow\', \'Orange\',\'Blue\']),false';'\'\''
    15;x;;'\'tr_3_td_3\'';;'new Color(246,246,246)';Wait;;'Wait';'\'Wait\'';;;;;;;true;'new ArrayList([\'Green\',\'Yellow\', \'Orange\',\'Blue\']),false';'\'\''
    16;x;;'\'tr_3_td_3\'';;'new Color(246,246,246)';ScrollBar;;getExp(plugin,'ScrollBar','ScrollBar','Vertical Scroll Bar');getExp(plugin,'\'ScrollBar\'','\'ScrollBar\'','\'Vertical Scroll Bar\'');0;;;'ScrollBar_30';;;true;'new ArrayList([\'Green\',\'Yellow\', \'Orange\',\'Blue\']),false';'\'0\''
    17;x;;'\'[JTree][Orange]\'';'{value=[JTree][Orange]}';'new Color(246,246,246)';Tree;;'Tree';'\'Tree\'';;;;;;;true;'new ArrayList([\'Green\',\'Yellow\', \'Orange\',\'Blue\']),false';'\'\''
    18;x;;'\'[JTree][Orange]\'';;'new Color(246,246,246)';Splitter;;'Splitter';'\'Splitter\'';125;;;'Splitter_30';;;true;'new ArrayList([\'Green\',\'Yellow\', \'Orange\',\'Blue\']),false';'\'125\''
    19;x;'Do.use(\'Menu2\').move()';'\'[JTree][Orange]\'';;'new Color(246,246,246)';Tooltip;;;'\'Tooltip\'';'Tooltip';;'Tooltip';;;;true;'new ArrayList([\'Green\',\'Yellow\', \'Orange\',\'Blue\']),false';'\'Tooltip\''
    20;x;'Do.use(\'Menu2\').click(200,10)';'\'[JTree][Orange]\'';;'new Color(246,246,246)';Menu;;'Menu';'\'Menu\'';;;'Menu';;;;true;'new ArrayList([\'Green\',\'Yellow\', \'Orange\',\'Blue\']),false';'\'\''
    21;x;'Do.use(\'Menu2\').click(200,10).click()';'\'[JTree][Orange]\'';;'new Color(246,246,246)';MenuItem;;'MenuItem';'\'MenuItem\'';;;'MenuItem';;;;true;'new ArrayList([\'Green\',\'Yellow\', \'Orange\',\'Blue\']),false';'\'\''
    22;x;'Do.use(\'TabPanel\').select(\'Green\')';'\'[JTree][Orange]\'';;'new Color(246,246,246)';TabPanel;;'TabPanel';'\'TabPanel\'';'Green';'Blue';'TabPanel';;;'[Green, Yellow, Orange, Blue]';true;'new ArrayList([\'Green\',\'Yellow\', \'Orange\',\'Blue\']),false';'\'Green\''
    23;x;;'\'[JTree][Orange]\'';;'new Color(246,246,246)';Spinner;;'Spinner';'\'Spinner\'';getExp(plugin,'',0,'0');;'Spinner';;;;true;'new ArrayList([\'Green\',\'Yellow\', \'Orange\',\'Blue\']),false';'\'0\''
    #EndRawTable

    #Action;$Table;$Expression
    TableConsiderColumnsAs;controls;{'Before','getAttr','getValue','get','setValue','text','getList','check','getListPar','getValuePar','getAttrPar','colorPar','getRow','getRowPar','toggle','select'}

    #Id;#Global;#RawTable
    operations;1;Table
    @;On;Name;Operation;Actual;Par
    0;x;Do.check;Do.check(par);true;control.getValuePar
    1;x;Do.check(false);Do.check(par,false);true;control.getValuePar
    2;x;Do.check(x,y);Do.check(par,1,1);true;control.getValuePar
    3;x;Do.checkRegexp;Do.checkRegexp('\\w*');true;control.getValuePar
    4;x;Do.checkRegexp(false);Do.checkRegexp('\\w*',false);true;control.getValuePar
    5;x;Do.checkRegexp(x,y);Do.checkRegexp('\\w*',1,1);true;control.getValuePar
    6;x;Do.checkAttr;Do.checkAttr('name',par);true;control.getAttrPar
    7;x;Do.checkAttrRegexp;Do.checkAttrRegexp('name','[a-zA-Z0-9_ ]*');true;control.getAttrPar
    8;x;Do.checkList;Do.checkList(par);true;control.getListPar
    9;x;Do.checkColor;Do.use('colorButton').checkColor(5,5,new Color(255,0,0));true;control.colorPar
    10;x;getAttr;Do.getAttr('name');control.getAttr;
    11;x;getValue;Do.getValue();control.getValue;
    12;x;getValueXY;Do.getValue(1,1);control.getValue;
    13;x;get;Do.get();control.get;
    14;x;click;Do.click().use('centralLabel').getValue();control.Name + '_click';
    15;x;doubleClick;Do.click(2,2,MouseAction.LeftDoubleClick).use('centralLabel').getValue();control.Name + '_double_click';
    16;x;clickXY;Do.click(2,2).use('centralLabel').getValue();control.Name + '_click';
    17;x;forech;Do.foreach(Do.click(2,2,MouseAction.LeftDoubleClick)).use('centralLabel').getValue();control.Name + '_double_click';
    18;x;setValue;Do.setValue(30).use('sliderLabel').getValue();control.setValue;
    19;x;text;Do.text('Green').getValue();control.text;
    20;x;textTrue;Do.text('Green',true).getValue();control.text;
    21;x;textXY;Do.text('Green',1,1).getValue(1,1);control.text;
    22;x;push;Do.push().use('pushLabel').getValue();control.Name + '_push';
    23;x;getList;Do.getList();control.getList;
    24;x;Do.toggle;Do.toggle(true).toggle(false).toggle(true).getValue();control.toggle;
    25;x;Do.select(string);Do.select('Blue').delay(amount).getValue();control.select;
    26;x;Do.select(int);Do.select(0).delay(amount).getValue();control.getValue;
    27;x;Do.count;Do.count();1;
    28;x;Do.use;Do.use(0).count();1;
    29;x;Do.move;Do.move().use('moveLabel').getValue();control.Name + '_move';
    30;x;Do.move(x,y);Do.move(1,1).use('moveLabel').getValue();control.Name + '_move';
    31;x;Do.getRectangle;Do.use('colorButton').getRectangle();'java.awt.Rectangle[x=550,y=800,width=100,height=25]';'
    32;x;Do.getRow;Do.getRow(new StringCondition('Head3',par));control.getRow;control.getRowPar
    33;x;Do.getRowIndexes;Do.getRowIndexes(new StringCondition('Head3',par));'[2]';control.getRowPar
    34;x;Do.getRowByIndex;Do.getRowByIndex(2);control.getRow;
    35;x;Do.getRowWithColor;Do.getRowWithColor(2);getExp(plugin, '{Head1=value=\'tr_3_td_1\', color=Color[51, 51, 51], backColor=Color[255, 255, 255], Head2=value=\'tr_3_td_2\', color=Color[51, 51, 51], backColor=Color[255, 255, 255], Head3=value=\'tr_3_td_3\', color=Color[51, 51, 51], backColor=Color[255, 255, 255]}','{Head1=value=\'tr_3_td_1\', color=Color[51, 51, 51], backColor=Color[255, 255, 255], Head2=value=\'tr_3_td_2\', color=Color[51, 51, 51], backColor=Color[255, 255, 255], Head3=value=\'tr_3_td_3\', color=Color[51, 51, 51], backColor=Color[255, 255, 255]}',ErrorKind.FEATURE_NOT_SUPPORTED);
    36;x;Do.getColor;Do.use('colorButton').getColor(5,5);'java.awt.Color[r=255,g=0,b=0]';
    37;x;Do.getTableSize;Do.getTableSize();3;
    38;x;Do.getTable;Do.getTable();'Table [Head1, Head2, Head3]:3';
    39;x;Do.expand;Do.expand('[JTree][colors]').getRowIndexes(new StringCondition('Head3','[JTree, colors][red]'));'[4]';
    40;x;Do.collapse;Do.collapse('[JTree][colors]').getRowIndexes(new StringCondition('Head3','[JTree, colors][red]'));'[]';
    41;x;Do.wait;Do.use('buttonShowArea').click().wait('buttonHideArea', 10000, true).use('buttonHideArea').getAttr('name').click();'hideButton';
    42;x;Do.delay;Do.use('buttonShowArea').click().delay(100).use('buttonHideArea').getAttr('name').click();'hideButton';
    43;x;Do.repeat;Do.use('countButtonClear').click().use('countButton').repeat(2, Do.click()).use('countLabel').getValue();2;
    44;x;Do.press;Do.press(Keyboard.ESCAPE).use('pressLabel').getValue();control.Name + '_press_Escape';
    45;x;Do.keyDown;Do.keyDown(Keyboard.CONTROL).use('downUpLabel').getValue();control.Name + '_down_Control';
    46;x;Do.keyUp;Do.keyUp(Keyboard.CONTROL).use('downUpLabel').getValue();control.Name + '_up_Control';
    47;x;Do.isEnabled;Do.isEnabled();true;
    48;x;Do.isVisible;Do.isVisible();true;
    49;x;Do.isEnabled;Do.use('notEnabledButton').isEnabled();false;
    50;x;Do.isVisible;Do.use('invisibleButton').isVisible();getExp(plugin,false,false,ErrorKind.ELEMENT_NOT_FOUND);
    51;x;Do.script;Do.use('countButtonClear').click().script('counter = 99').use('countButton').click().use('countLabel').getValue();getExp(plugin,100,ErrorKind.FEATURE_NOT_SUPPORTED,ErrorKind.FEATURE_NOT_SUPPORTED);
    52;x;Do.dragNDrop;Do.use('Slider').setValue(0).dragNdrop(10, 6, 'Slider', 395, 6).use('sliderLabel').getValue();'Slider_50';
    #EndRawTable

    #Action;$Table;$Expression
    TableConsiderColumnsAs;operations;{'Actual','Par'}


#Id;#TestCase;#Kind;#Depends;#For
EXECUTE;;;;
    #Id;#Global;#Let
    adapter;1;parameter

    #If
    adapter == 'Web'
        #Call;plugin
        RUN;'Web'

    #EndIf

    #If
    adapter == 'Swing'
        #Call;plugin
        RUN;'Swing'

    #EndIf

    #If
    adapter == 'Win'
        #Call;plugin
        RUN;'Win'

    #EndIf

    #Id;#Action;$Decoraded
    RESTBL1;ResultTable;true

    #Action;$Table;$Title;$BeforeTestCase
    TableReport;RESTBL1.Out;'result';'INIT'


#Id;#TestCase;#Kind;#Depends;#For
SUBCASES;;;;
    #Id;#SubCase;plugin
    RUN;Run;'Swing'
        #Step;#Kind;#For;#Depends
        'start application';;;
            #Id;#Action;Plugin;Control;Operation;Time;Expected;Actual;Result
            TBL1;TableCreate;;;;;;;

            #Id;#Global;#Let
            table_result;1;TBL1.Out

            #Action;$Table;$Colored
            TableConsiderColumnsAs;table_result;'Result'

            #If
            plugin == 'Web'
                #Id;#Action;$AppId;Browser;URL
                APPSTR1;ApplicationStart;mockWebApp;mockWebBrowser;mockWebURL

                #Id;#Global;#Let
                appCon;1;APPSTR1.Out

            #EndIf

            #If
            plugin == 'Swing'
                #Id;#Action;$AppId;Jar;Args;MainClass
                APPSTR1;ApplicationStart;mockSwingApp;mockSwingJar;'';mockSwingClass

                #Id;#Global;#Let
                appCon;1;APPSTR1.Out

            #EndIf

            #If
            plugin == 'Win'
                #Id;#Action;$AppId;Exec;WorkDir;Args
                APPSTR1;ApplicationStart;mockWinApp;mockWinExec;mockWinDir;''

                #Id;#Global;#Let
                appCon;1;APPSTR1.Out

            #EndIf

            #Id;#Global;#Let
            failedOwn;1;false

        #EndStep

        #ForEach;#In
        control;controls
            #If
            control.On.equals('')
                #Continue

            #EndIf

            #Step;#Kind;#For;#Depends
            plugin + ' - '+ control.Name;;;
                #Id;#Let
                failed;false

                #Id;#Let
                field;'DLG.Out.' + control.Name

                #Id;#Let
                needNum;-1

                #ForEach;#In
                operation;operations
                    #Id;#Let
                    startTime;DateTime.current().getTime()

                    #Id;#Let
                    needNum;needNum + 1

                    #If
                    operation.On.equals('')
                        #Continue

                    #EndIf

                    #Id;#Let
                    before;Do.use(control.Name).delay(1)

                    #Id;#Let
                    op;operation.Operation

                    #If
                    operation.Operation.contains('par')
                        #If
                        operation.Par != null
                            #Id;#Let
                            op;op.replace('par',operation.Par)

                        #EndIf

                    #EndIf

                    #If
                    operation.Operation.contains('amount')
                        #Id;#Let
                        op;op.replace('amount',getDelay(plugin).toString())

                    #EndIf

                    #If
                    control.Before != null
                        #Id;#Let
                        before;control.Before

                    #EndIf

                    #Id;#Action;$Dialog;$AppConnection;$Fields
                    DLG;DialogFill;'Main';appCon;{ '' : before, control.Name : op}

                    #Assert;#Message
                    evaluator.evaluate(field).toString() == operation.Actual.toString();

                    #Action;$Table;Plugin;Control;Operation;Time;Expected;Actual;Result
                    TableAddValue;table_result;plugin;control.Name;operation.Name;DateTime.current().getTime() - startTime;evaluator.evaluate(field);operation.Actual;'OK'

                    #Action;
                    Print;control.Name + ' - ' + operation.Name + ' (' + (DateTime.current().getTime() - startTime) + ')'

                    #OnError
                        #Switch
                        DLG.Kind
                            #Case
                            ErrorKind.OPERATION_NOT_ALLOWED
                                #If
                                appCon.getDictionary().getWindow('Main').getControlForName(null, control.Name).getBindedClass().isAllowed(evaluator.evaluate(op).getOperationKind(0)) == false || appCon.getApplication().getFactory()isAllowed(appCon.getDictionary().getWindow('Main').getControlForName(null, control.Name).getBindedClass(), evaluator.evaluate(op).getOperationKind(0)) == false
                                    #Action;$Table;Plugin;Control;Operation;Time;Expected;Actual;Result
                                    TableAddValue;table_result;plugin;control.Name;operation.Name;DateTime.current().getTime() - startTime;'OPERATION IS NOT ALLOWED';'OPERATION IS NOT ALLOWED';'OK'

                                    #Action;
                                    Print;control.Name + ' - ' + operation.Name + ' (' + (DateTime.current().getTime() - startTime) + ')'

                                #Else
                                    #Action;$Table;Plugin;Control;Operation;Time;Expected;Actual;Result
                                    TableAddValue;table_result;plugin;control.Name;operation.Name;DateTime.current().getTime() - startTime;'OPERATION_CHECK_FAILED';'OPERATION_CHECK_FAILED';'FAILED'

                                    #Action;
                                    Print;control.Name + ' - ' + operation.Name + ' (' + (DateTime.current().getTime() - startTime) + ')'

                                    #Id;#Let
                                    failed;true


                                #EndIf

                                #Continue


                            #Case
                            ErrorKind.FEATURE_NOT_SUPPORTED
                                #If
                                operation.Actual == ErrorKind.FEATURE_NOT_SUPPORTED
                                    #Action;$Table;Plugin;Control;Operation;Time;Expected;Actual;Result
                                    TableAddValue;table_result;plugin;control.Name;operation.Name;DateTime.current().getTime() - startTime;'FEATURE_NOT_SUPPORTED';'FEATURE_NOT_SUPPORTED';'OK'

                                #Else
                                    #Action;$Table;Plugin;Control;Operation;Time;Expected;Actual;Result
                                    TableAddValue;table_result;plugin;control.Name;operation.Name;DateTime.current().getTime() - startTime;'FEATURE_NOT_SUPPORTED';'FEATURE_NOT_SUPPORTED';'FAILED'

                                    #Id;#Let
                                    failed;true


                                #EndIf

                                #Continue


                            #Case
                            ErrorKind.CONTROL_NOT_SUPPORTED
                                #If
                                appCon.getApplication().getFactory().getInfo().isSupported(appCon.getDictionary().getWindow('Main').getControlForName(null, control.Name).getBindedClass()) == false
                                    #Action;$Table;Plugin;Control;Operation;Time;Expected;Actual;Result
                                    TableAddValue;table_result;plugin;control.Name;operation.Name;DateTime.current().getTime() - startTime;'ELEMENT IS NOT SUPPORTED';'ELEMENT IS NOT SUPPORTED';'OK'

                                    #Action;
                                    Print;control.Name + ' - ' + operation.Name + ' (' + (DateTime.current().getTime() - startTime) + ')'

                                #Else
                                    #Action;$Table;Plugin;Control;Operation;Time;Expected;Actual;Result
                                    TableAddValue;table_result;plugin;control.Name;operation.Name;DateTime.current().getTime() - startTime;'CONTROL_CHECK_FAILED';'CONTROL_CHECK_FAILED';'FAILED'

                                    #Action;
                                    Print;control.Name + ' - ' + operation.Name + ' (' + (DateTime.current().getTime() - startTime) + ')'

                                    #Id;#Let
                                    failed;true


                                #EndIf

                                #Continue


                            #Case
                            ErrorKind.ELEMENT_NOT_FOUND
                                #If
                                operation.Actual == ErrorKind.ELEMENT_NOT_FOUND
                                    #Action;$Table;Plugin;Control;Operation;Time;Expected;Actual;Result
                                    TableAddValue;table_result;plugin;control.Name;operation.Name;DateTime.current().getTime() - startTime;'ELEMENT_NOT_FOUND';'ELEMENT_NOT_FOUND';'OK'

                                    #Action;
                                    Print;control.Name + ' - ' + operation.Name + ' (' + (DateTime.current().getTime() - startTime) + ')'

                                #Else
                                    #Action;$Table;Plugin;Control;Operation;Time;Expected;Actual;Result
                                    TableAddValue;table_result;plugin;control.Name;operation.Name;DateTime.current().getTime() - startTime;'ELEMENT_NOT_FOUND';'ELEMENT_NOT_FOUND';'FAILED'

                                    #Action;
                                    Print;control.Name + ' - ' + operation.Name + ' (' + (DateTime.current().getTime() - startTime) + ')'

                                    #Id;#Let
                                    failed;true


                                #EndIf

                                #Continue


                            #Case
                            ErrorKind.EXCEPTION
                                #Action;$Table;Plugin;Control;Operation;Time;Expected;Actual;Result
                                TableAddValue;table_result;plugin;control.Name;operation.Name;DateTime.current().getTime() - startTime;'EXCEPTION';'EXCEPTION';'FAILED'

                                #Action;
                                Print;control.Name + ' - ' + operation.Name + ' (' + (DateTime.current().getTime() - startTime) + ')'

                                #Id;#Let
                                failed;true

                                #Continue


                            #Default
                                #Action;$Table;Plugin;Control;Operation;Time;Expected;Actual;Result
                                TableAddValue;table_result;plugin;control.Name;operation.Name;DateTime.current().getTime() - startTime;evaluator.evaluate(field);operation.Actual;'FAILED'

                                #Action;
                                Print;control.Name + ' - ' + operation.Name + ' (' + (DateTime.current().getTime() - startTime) + ')'

                                #Id;#Let
                                failed;true


                        #EndSwitch


                #EndForEach

                #Assert;#Message
                failed == false;'fail'

            #EndStep

            #OnError
                #Id;#Let
                failedOwn;true


        #EndForEach

        #Step;#Kind;#For;#Depends
        'close application';;;
            #Id;#Action;$AppConnection
            APPSTP1;ApplicationStop;appCon

            #Action;$Table;$Title;$BeforeTestCase
            TableReport;table_result;'Result';'INIT'

            #Assert;#Message
            failedOwn == false;'failedOwn'

        #EndStep

    #EndSubCase


